# 2장. **메모리 관리**

  * [2-1 메모리 단편화와 성능에 미치는 영향](#2-1-메모리-단편화와-성능에-미치는-영향) 
  * [2-2 NUMA 아키텍처와 메모리 관리에 미치는 영향](#2-2-numa-아키텍처와-메모리-관리에-미치는-영향) 
  * [2-3 메모리 누수 탐지 및 디버깅 기술](#2-3-메모리-누수-탐지-및-디버깅-기술)

메모리 관리는 컴퓨터 시스템에서 메모리 리소스를 관리하는 프로세스이다.  
간단히 말해, 메모리를 여러 프로세스에 할당하고 각 프로세스가 필요한 메모리에 액세스할 수 있도록 해당 메모리를 관리하는 것이다.

최신 컴퓨터 시스템에서는 여러 프로세스가 동시에 실행되는 경우가 많으며, 모든 프로세스가 메모리에 액세스해야 하기 때문에 메모리 관리가 필수적이다.  
효과적인 메모리 관리가 이루어지지 않으면 이러한 프로세스가 서로 간섭하여 시스템 충돌이나 기타 오류가 발생할 수 있다.

* 메모리 관리는 작동 원리  
  메모리 관리는 사용 가능한 메모리를 `page`라고 하는 작은 블록으로 나누는 방식으로 작동한다.  
  그런 다음 이러한 페이지는 필요에 따라 다른 프로세스에 할당된다.  
  운영 체제는 각 프로세스에서 현재 사용 중인 페이지와 할당 가능한 페이지에 대한 기록을 유지한다.

  프로세스가 특정 메모리에 액세스해야 하는 경우 운영 체제에 요청을 보낸다.  
  운영 체제는 레코드를 확인하여 해당 메모리가 현재 다른 프로세스에 할당되어 있는지 확인한다.  
  메모리가 할당된 경우 운영 체제는 해당 메모리가 확보될 때까지 기다리거나 요청하는 프로세스에 다른 메모리를 할당한다.

  메모리 관리에는 프로세스가 시스템에서 물리적으로 사용할 수 있는 메모리보다 더 많은 메모리에 액세스할 수 있도록 하는 기술인 가상 메모리 관리도 포함된다.  
  이는 물리적 메모리와 하드 디스크 간에 메모리 페이지를 스왑하여 이루어진다.

* 메모리 관리가 필수적인 이유  
  1. 리소스 할당  
    메모리 관리는 각 프로세스가 필요한 메모리에 액세스할 수 있도록 한다.  
    효과적인 메모리 관리가 없으면 프로세스가 서로 간섭하여 시스템 충돌이나 기타 오류가 발생할 수 있다.
  2. 효율성  
    메모리 관리는 특정 요구 사항을 충족하는 방식으로 메모리 리소스가 할당되도록 하여 시스템 효율성을 향상시킬 수 있다.  
    이를 통해 지연을 줄이고 시스템 성능을 개선할 수 있다.
  3. 보안  
    메모리 관리는 프로세스가 액세스해서는 안 되는 메모리에 액세스하지 못하도록 하여 시스템 보안을 개선할 수 있다.  
    이를 통해 보안 침해를 방지하고 중요한 데이터를 보호할 수 있다.
  4. 안정성  
    효과적인 메모리 관리는 시스템 충돌을 일으킬 수 있는 메모리 누수나 기타 오류를 방지하여 시스템 안정성을 보장할 수 있다.

## 2-1 메모리 단편화와 성능에 미치는 영향
  메모리 단편화는 시스템 성능에 중대한 영향을 미칠 수 있는 Linux 커널의 일반적인 문제이다.  
  메모리 단편화의 정의, 메모리 단편화가 발생하는 이유, 시스템 성능에 미치는 영향에 대해 알아보자.

  1. 메모리 단편화란?  
      메모리 단편화는 시스템에 메모리 공간 전체에 흩어져 있는 작은 메모리 블록이 많을 때 발생한다.  
      더 큰 메모리 블록이 요청되면 사용 가능한 연속된 메모리 블록이 없기 때문에 시스템에서 이를 제공할 수 없다.  
      이로 인해 작은 블록 사이에 사용되지 않는 메모리 공간이 발생하는데, 이를 메모리 단편화라고 한다.

      메모리 단편화는 다음과 같은 다양한 원인으로 인해 발생할 수 있다.
      
      1. 동적 메모리 할당  
        프로세스가 동적으로 메모리를 요청하면 메모리 공간 전체에 작은 메모리 블록이 흩어질 수 있다.
      2. 메모리 할당 및 할당 해제  
        메모리를 자주 할당하고 할당 해제하는 경우에도 메모리 단편화가 발생할 수 있으며, 그 결과 작은 메모리 블록이 메모리 공간 전체에 흩어져 남게 된다.
      3. 메모리 누수  
        메모리 누수는 사용하지 않는 작은 메모리 블록을 메모리 공간 전체에 흩어지게 하여 메모리 단편화를 유발할 수도 있다.

  2. 시스템 성능에 미치는 영향  
      메모리 단편화는 시스템 성능에 다음과 같은 중대한 영향을 미칠 수 있다.

      1. 메모리 효율성 감소  
        메모리 단편화는 작은 메모리 블록 사이에 사용되지 않는 공간을 남겨두어 메모리 사용의 효율성을 떨어뜨린다.
      2. 메모리 가용성 감소  
        메모리 단편화로 인해 더 큰 메모리 블록을 사용하지 못할 수 있으므로 메모리 단편화는 사용 가능한 메모리 양을 줄일 수 있다.
      3. 메모리 할당 시간 증가  
        메모리 단편화는 시스템이 인접한 메모리 블록을 검색해야 하므로 메모리 할당에 필요한 시간을 증가시킬 수 있다.
      4. 메모리 액세스 시간 증가  
        메모리 단편화는 시스템이 필요한 데이터에 액세스하기 위해 흩어져 있는 메모리 블록을 검색해야 할 수 있으므로 메모리 액세스에 필요한 시간도 증가시킬 수 있다.
      5. swap 사용량 증가  
        메모리 단편화는 인접한 메모리 블록을 확보하기 위해 시스템에서 메모리를 교체해야 할 수 있으므로 swap 사용량을 증가시킬 수 있다.
  
  3. 메모리 단편화 방지  
      메모리 단편화를 방지하는 방법에는 다음과 같은 여러 가지가 있다.

      1. 메모리 풀 사용  
        메모리 풀을 사용하면 메모리를 고정 크기 블록으로 할당하여 메모리 블록이 작고 흩어질 가능성을 줄일 수 있다.
      2. 메모리 사전 할당  
        메모리를 사전 할당하면 메모리를 동적으로 할당하는 대신 큰 메모리 블록을 한 번에 할당하여 메모리 단편화를 줄일 수 있다.
      3. 가비지 컬렉션 사용  
        가비지 컬렉션을 사용하면 사용하지 않는 메모리 블록을 확보하여 메모리 공간의 단편화 양을 줄일 수 있다.

## 2-2 NUMA 아키텍처와 메모리 관리에 미치는 영향
(Non-Uniform Memory Access)
## 2-3 메모리 누수 탐지 및 디버깅 기술