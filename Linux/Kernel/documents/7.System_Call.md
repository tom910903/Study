# 7장. System call

  * [7-1 시스템 호출(System Call)이란?](#7-1-시스템-호출system-call이란)

## 7-1 시스템 호출(System Call)이란?
  운영 체제의 세계에서 시스템 호출은 사용자 수준의 프로세스가 기반이 되는 운영 체제 커널과 상호 작용할 수 있는 기본 메커니즘이다.  
  시스템 호출은 권한이 있는 작업을 실행하고 시스템 리소스에 액세스하기 위한 제어된 인터페이스를 제공한다.

  1. 시스템 호출 이해하기  
      높은 수준에서 시스템 호출은 사용자 수준 애플리케이션과 운영 체제 사이의 경계로 작동한다.  
      이를 통해 사용자 프로그램은 파일 입출력, 프로세스 생성, 네트워크 통신, 하드웨어 장치 액세스와 같이 일반적으로 커널에 제한된 기능과 서비스를 요청할 수 있다.  
      시스템 호출은 잘 정의된 인터페이스를 제공함으로써 사용자 프로그램이 특권을 가진 커널 모드에 직접 액세스하지 않고도 운영 체제의 기능을 활용할 수 있게 한다.

  2. 시스템 호출의 목적  
      시스템 호출의 주요 목적은 사용자 수준 프로세스가 특권 있는 작업을 실행할 수 있는 안전하고 제어된 메커니즘을 제공하는 것이다.  
      이러한 작업은 종종 하드웨어, 특권 명령어 또는 운영 체제에서 보호되고 관리되는 중요한 시스템 리소스에 액세스해야 하는 경우가 많다.  
      시스템 호출을 사용함으로써 사용자 프로그램은 이러한 서비스를 제어된 방식으로 요청할 수 있으며, 인가된 작업만 수행되고 시스템 리소스에 대한 무단 액세스나 남용을 방지할 수 있다.

## 7-2 시스템 콜의 전체 흐름과 계층
  아래는 시스템 콜의 전체 흐름이다.  
  <center><img src="../images/7.System_Call/System_call_flow.png" width="90%" height="90%"></center>

  시스템 콜의 세부 실행 단계는 다음과 같다.  

  1. Linux 저수준 표준 함수 호출  
      - 사용자 프로그램이 직접 Linux 저수준 표준 함수를 호출한다.
      - 함수 호출은 링커/로더에 의해 해결되고 해당 라이브러리 함수에 링크된다.
      - 함수는 호출하는 프로세스의 사용자 공간에서 실행된다.
      - 함수는 사용자 프로그램을 대신하여 일부 작업을 수행하거나 추가적인 시스템 호출을 수행할 수 있다.

  2. User 공간에서 시스템 호출 실행  
      - 사용자 프로그램은 래퍼 함수나 시스템 호출 라이브러리와 같은 고수준 인터페이스를 사용하여 시스템 호출을 수행한다.
      - 고수준 인터페이스는 시스템 호출을 특정 함수 호출로 변환힌다.
      - 함수 호출은 호출하는 프로세스의 사용자 공간에서 실행된다.
      - 함수는 커널 공간으로 전환하기 전에 일부 초기 유효성 검사나 준비 작업을 수행할 수 있다.

  3. 커널 공간에서 시스템 호출 실행  
      - 사용자 공간에서의 함수 호출은 모드 전환을 트리거하여 사용자 모드에서 커널 모드로 전환한다.
      - CPU는 운영 체제의 커널에게 제어를 전달힌다.
      - 커널은 제공된 식별자나 번호를 기반으로 요청된 시스템 호출을 식별한다.
      - 커널은 시스템 호출과 관련된 매개변수와 권한을 유효성 검사한다.
      - 커널은 요청된 작업을 수행하기 위해 해당하는 시스템 호출 핸들러를 실행한다.
      - 시스템 호출의 실행은 커널 공간에서 발생한다.

  4. 시스템 호출 핸들러 실행  
      - 시스템 호출 핸들러는 특정 시스템 호출을 실행하는 커널 수준 루틴이다.
      - 핸들러는 사용자 프로그램으로부터 매개변수를 받아 필요한 작업을 수행한다.
      - 핸들러는 하드웨어에 액세스하거나 시스템 상태를 수정하거나 다른 커널 하위 시스템과 상호 작용할 수 있다.
      - 핸들러는 오류 처리를 수행하고 결과나 상태를 호출 컨텍스트에 반환한다.
      - 시스템 호출 핸들러가 완료되면 제어가 커널로 반환되고, 특정 컨텍스트에 따라 추가 처리가 진행될 수 있다.
