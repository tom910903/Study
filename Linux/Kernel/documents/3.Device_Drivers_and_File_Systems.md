# 3장. **디바이스 드라이버 및 파일 시스템**

  * [문자 장치 및 블록 장치 드라이버](#3-1-문자-장치-및-블록-장치-드라이버)
  * [파일 시스템 유형 및 특성](#3-2-파일-시스템-유형-및-특성)
  * [액세스 제어 목록 및 파일 시스템 권한](#3-3-액세스-제어-목록-및-파일-시스템-권한)

## 3-1 문자 장치 및 블록 장치 드라이버  
  Linux 커널에서 장치 드라이버는 하드웨어 장치를 제어하고 통신하는 역할을 담당한다.  
  장치 드라이버에는 문자 장치 드라이버와 블록 장치 드라이버라는 두 가지 주요 유형이 있다.  
  장치 드라이버에 대해 알아보자.  

  1. 문자 장치 드라이버  
      문자 장치 드라이버는 한 번에 한 문자씩 데이터를 송수신할 수 있는 장치 드라이버 유형이다.  
      이 유형의 드라이버는 직렬 포트, 키보드 및 마우스와 같이 문자 스트림으로 액세스할 수 있는 장치에 사용된다.  
      
      문자 장치 드라이버는 장치 파일을 통해 사용자 공간 애플리케이션과 통신한다.  
      사용자 공간 애플리케이션이 문자 장치에서 읽거나 쓰기를 원할 때 해당 장치 파일을 열고 파일 설명자에 대한 읽기 또는 쓰기 작업을 수행한다.  
      그런 다음 드라이버는 이러한 작업을 하드웨어 장치에 대한 요청으로 변환한다.  
      
      문자 장치 드라이버는 다양한 커널 API와 데이터 구조를 사용하여 해당 기능을 구현한다.  
      여기에는 장치 파일에서 수행할 수 있는 연산을 정의하는 `file_operations` 구조체와 드라이버가 인터럽트와 같은 비동기 이벤트를 사용자 공간 애플리케이션에 알릴 수 있도록 하는 `fasync` 메커니즘이 포함된다.

  2. 블록 장치 드라이버  
      블록 장치 드라이버는 데이터 블록으로 데이터를 송수신할 수 있는 장치 드라이버의 한 유형이다.  
      이 유형의 드라이버는 하드 디스크, USB 드라이브 및 SD 카드와 같이 랜덤 액세스 블록 장치로 액세스할 수 있는 장치에 사용된다.  

      블록 장치 드라이버는 블록 장치 파일을 통해 사용자 공간 애플리케이션과 통신한다.  
      사용자 공간 애플리케이션이 블록 장치에서 읽거나 블록 장치에 쓰려고 하면 해당 블록 장치 파일을 열고 파일 설명자에 대한 읽기 또는 쓰기 작업을 수행한다.  
      그런 다음 드라이버는 이러한 작업을 하드웨어 장치에 대한 요청으로 변환한다.

      블록 장치 드라이버는 다양한 커널 API와 데이터 구조를 사용하여 해당 기능을 구현한다.  
      여기에는 블록 장치에서 수행할 수 있는 연산을 정의하는 `block_device_operations` 구조체와 장치에서 데이터 요청을 관리하는 `request_queue` 메커니즘이 포함된다.

  3. 문자 장치 드라이버와 블록 장치 드라이버의 차이점  
      문자 장치 드라이버와 블록 장치 드라이버의 주요 차이점은 데이터 전송 및 통신 방식에 있다.  
      문자 장치 드라이버는 한 번에 한 문자씩 데이터를 전송하며 문자 스트림으로 액세스할 수 있는 장치에 사용된다.  
      블록 장치 드라이버는 데이터를 블록 단위로 전송하며 랜덤 액세스 블록 장치로 액세스할 수 있는 장치에 사용된다.
      
      또 다른 주요 차이점은 데이터 버퍼링을 처리하는 방식에 있다.  
      문자 장치 드라이버는 일반적으로 한 번에 한 문자씩 데이터를 처리하기 때문에 버퍼가 더 작다.  
      반면에 블록 장치 드라이버는 블록 단위로 데이터를 처리하므로 일반적으로 더 큰 버퍼를 사용한다.

## 3-2 파일 시스템 유형 및 특성
  파일 시스템은 Linux를 포함한 모든 운영 체제의 필수적인 부분이다.  
  파일 시스템은 저장 장치의 파일, 디렉터리 및 기타 데이터를 관리한다.  
  Linux에는 각각 고유한 특성과 기능을 가진 여러 유형의 파일 시스템을 사용할 수 있다.  
  ext2/3/4, Btrfs, XFS 및 ZFS를 포함하여 Linux에서 가장 일반적으로 사용되는 파일 시스템에 대해 알아보자.

  1. ext2/3/4  
      ext 파일 시스템 제품군은 Linux에서 가장 오래되고 가장 널리 사용되는 파일 시스템이다.  
      ext2는 수년 동안 기본 파일 시스템이었지만 지금은 ext3와 ext4로 대체되었다.  
      ext3에 비해 ext4의 주요 장점은 향상된 성능과 확장성, 그리고 더 큰 파일 시스템과 파일을 지원한다는 것이다.

      ext 파일 시스템의 중요한 한계 중 하나는 내장된 데이터 보호 및 복구 메커니즘이 없다는 것이다.  
      예기치 않은 정전이나 시스템 충돌이 발생하면 데이터가 손상되거나 손실될 수 있다.  
      또 다른 단점은 최적의 성능을 유지하기 위해 파일 시스템을 주기적으로 조각 모음해야 한다는 것이다.

  2. Btrfs  
      Btrfs는 ext 파일 시스템 계열의 한계를 해결하기 위해 설계된 비교적 새로운 파일 시스템이다.  
      이 파일 시스템은 Copy-On-Write 파일 시스템으로, 데이터를 수정할 때마다 기존 데이터를 덮어쓰지 않고 새 위치에 기록힌다.  
      이 방식은 정전이나 시스템 충돌 시에도 데이터가 손상되지 않도록 보장힌다.

      Btrfs는 스냅샷, 하위 볼륨, 온라인 크기 조정과 같은 고급 기능을 지원하므로 데스크톱과 서버 시스템에 좋은 선택이 될 수 있다.  
      단점 중 하나는 다른 파일 시스템에 비해 상대적으로 느린 성능이다.

  3. XFS  
      XFS는 실리콘 그래픽스에서 처음 개발한 고성능 저널링 파일 시스템이다.  
      대용량 파일과 파일 시스템을 효율적으로 처리하도록 설계되었으며 수백만 개의 파일과 Terabyte의 데이터를 처리할 수 있도록 확장할 수 있다.  
      XFS는 스냅샷, 하위 볼륨, 온라인 크기 조정과 같은 고급 기능을 지원하므로 데스크톱과 서버 시스템에 좋은 선택이 될 수 있다.

      XFS의 중요한 단점 중 하나는 내장된 데이터 보호 및 복구 메커니즘이 없다는 것이다.  
      예기치 않은 정전이나 시스템 충돌이 발생하면 데이터가 손상되거나 손실될 수 있다.  
      또 다른 한계는 XFS가 파일 시스템 압축을 지원하지 않는다는 것이다.

  4. ZFS  
      ZFS는 원래 "Sun Microsystems"에서 개발한 고성능, 쓰기 시 복사 파일 시스템이다.  
      데이터 압축, 스냅샷, 볼륨 관리와 같은 고급 기능으로 잘 알려져 있다.  
      또한 ZFS는 복원력이 뛰어나며 데이터 오류를 즉시 감지하고 수정할 수 있다.

      ZFS의 중요한 장점 중 하나는 디스크를 조합하여 필요에 따라 동적으로 확장할 수 있는 스토리지 풀을 생성할 수 있다는 점이다.  
      이 기능은 대규모 스토리지 시스템에 이상적이다.  
      그러나 ZFS는 Linux 커널에서 지원되지 않으므로 별도로 설치해야 한다.

## 3-3 액세스 제어 목록 및 파일 시스템 권한