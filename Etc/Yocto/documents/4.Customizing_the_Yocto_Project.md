# 4장. **Yocto 프로젝트 커스터마이징**

* [4-1 이미지에 새 패키지 추가하기](#4-1-이미지에-새-패키지-추가하기)
* [4-2 기존 레시피 수정하기](#4-2-기존-레시피-수정하기)
* [4-3 사용자 지정 레시피 생성](#4-3-사용자-지정-레시피-생성)
* [4-4 기본 빌드 구성 재정의](#4-4-기본-빌드-구성-재정의)

## 4-1 이미지에 새 패키지 추가하기  
  Yocto는 아주 유연하고 확장 가능한 프레임워크를 제공한다.  
  즉, 이미지에 새 패키지를 추가하기 매우 편리하다.

  * Yocto의 패키지 이해하기  
    Yocto 프로젝트 용어에서 패키지는 소프트웨어 구성 요소를 나타내는 파일 및 메타데이터 모음을 의미한다.  
    패키지에는 소프트웨어 컴포넌트를 빌드하고 설치하는 데 필요한 소스 코드, 라이브러리, 구성 파일 및 스크립트가 포함된다.  

  * 패키지 찾기 및 추가하기  
    Yocto 프로젝트 이미지에 새 패키지를 추가하려면 먼저 추가하려는 패키지를 찾아야 한다.  
    일반적인 소프트웨어 구성 요소에 대해 미리 빌드된 수천 개의 레시피가 포함된 Yocto 프로젝트의 레시피 레포지토리에서 패키지를 검색할 수 있다.  
    추가하려는 패키지를 찾았다면 Yocto 프로젝트 작업 영역에 새 레시피 파일을 추가하여 빌드 환경에 추가할 수 있다.  
    레시피 파일은 패키지를 빌드하고 설치하는 방법을 지정하는 스크립트이다.

  * 레시피 파일 만들기  
    새 레시피 파일을 만들려면 텍스트 편집기를 사용하여 확장자가 `.bb`인 새 파일을 만들어야 한다.  
    파일 이름은 추가하려는 패키지의 이름을 따서 지정한다.  
    그리고 레시피 파일에 패키지의 이름, 버전, 패키지를 다운로드할 수 있는 소스 URL을 지정한다.  
    또한 패키지에 포함된 종속성과 설정해야 하는 빌드 옵션도 지정해야 한다.

  * 패키지 빌드하기  
    레시피 파일을 만들었으면 레시피 파일 이름을 인수로 사용하여 bitbake 명령(`bitbake <패키지명>`)을 실행하여 패키지를 빌드할 수 있다.  
    이렇게 하면 소스 코드를 가져와 컴파일하고 대상 디바이스에 설치할 수 있는 바이너리 패키지가 생성된다.
  
  * 이미지에 패키지 추가하기  
    패키지를 `local.conf` 파일의 `IMAGE_INSTALL` 변수에 추가하여 Yocto 프로젝트 이미지에 추가한다.  

## 4-2 기존 레시피 수정하기
  Yocto 프로젝트의 주요 기능 중 하나는 기존 레시피를 수정하여 빌드 프로세스를 사용자 정의하거나 기존 패키지에 새로운 기능을 추가할 수 있는 기능이다. 

  * Yocto의 레시피 이해하기  
    Yocto 프로젝트 용어에서 레시피는 패키지를 빌드하고 설치하는 방법을 지정하는 스크립트이다.  
    레시피에는 일반적으로 패키지 이름, 버전, 소스 URL 및 설정해야 하는 빌드 옵션과 같은 정보가 포함된다.  
    레시피는 일반적인 소프트웨어 구성 요소에 대해 미리 빌드된 수천 개의 레시피가 포함된 Yocto 프로젝트의 레시피 리포지토리에 저장된다.

  * 수정할 레시피 찾기  
    기존 레시피를 수정하려면 Yocto 프로젝트의 레시피 저장소에서 해당 레시피 파일을 찾아야 한다.  
    빌드 환경의 모든 layer와 레시피를 나열하는 `bitbake-layers` 명령을 사용하여 레시피를 검색할 수 있다.  
    레시피 파일을 찾으면 layer나 작업 공간에 복사하여 원본 레시피에 영향을 주지 않고 수정할 수 있다.

  * 레시피 수정하기  
    레시피를 수정하려면 텍스트 편집기를 사용하여 레시피 파일을 열어야 한다.  
    그런 다음 소스 URL을 업데이트하거나 빌드 옵션을 수정하거나 패키지에 새 파일을 추가하는 등 레시피에 필요한 변경을 수행할 수 있다.  
    레시피에 패치를 추가하여 패키지의 소스 코드를 수정할 수도 있다.

  * 수정된 레시피 빌드하기  
    레시피를 수정한 후에는 레시피 파일 이름을 인수로 사용하여 bitbake 명령(`bitbake <패키지명>`)을 실행하여 패키지를 빌드할 수 있다.  
    이렇게 하면 소스 코드를 가져오고, 패치를 적용하고, 패키지를 컴파일하고, 대상 장치에 설치할 수 있는 바이너리 패키지가 생성된다.

  * 수정된 패키지 테스트하기  
    수정된 패키지를 빌드한 후에는 예상대로 작동하는지 테스트해야 한다.  
    대상 디바이스에 패키지를 설치하고 필요한 테스트 또는 벤치마크를 실행하여 테스트할 수 있다.

  * 커뮤니티에 다시 기여하기  
    기존 레시피를 크게 수정한 경우, 변경 사항을 Yocto 프로젝트 커뮤니티에 다시 기여하는 것을 고려할 수 있다.  
    이렇게 하면 레시피의 품질을 개선하고 다른 사람들이 더 쉽게 사용하고 수정하는 데 도움이 될 수 있다.
  
## 4-3 사용자 지정 레시피 생성
## 4-4 기본 빌드 구성 재정의